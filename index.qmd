---
title: "Green Space Inequality via Spatial Income Patterns."
author: "Xun Lei"
affiliation: "Georgetown University"
format:
  html:
    toc: true
    toc-depth: 3
    toc-location: left       
    number-sections: true   

execute:
  echo: false       
  warning: false    
  message: false   
---


# Introduction

Urban green space—such as parks, gardens, and recreational areas—is widely recognized as a critical component of environmental quality and public well-being. Access to green space has been linked to improved physical and mental health, greater opportunities for recreation, lower levels of urban heat exposure, and enhanced social cohesion within communities. As cities grow and densify, the equitable distribution of parks becomes a central concern in urban planning and environmental justice.

Many studies in environmental justice have found that socially advantaged neighborhoods often enjoy better access to ecological and recreational amenities, while lower-income communities may face “green space deficits.” These disparities can contribute to unequal health outcomes, reduced quality of life, and structural inequities embedded within the urban landscape.

This project investigates the spatial distribution of parks in Washington, D.C. and evaluates whether higher-income neighborhoods receive disproportionately greater access to green space. Specifically, the study focuses on first-order spatial properties through the estimation of an inhomogeneous intensity function and employs simulation-based hypothesis testing to assess whether observed patterns differ significantly from those expected under a population-driven null model.

By integrating open-source geospatial data with point-pattern methods from spatial statistics, this research contributes to understanding the extent of environmental inequality in the nation’s capital and highlights broader implications for urban planning and equitable resource allocation.

---

# Literature Review

Wolch, Byrne, and Newell (2014), Boone et al. (2009), and Schwarz et al. (2018) analyze the relationship between **environmental justice** and the spatial distribution of urban green space. Their key findings are that:

> Higher-income neighborhoods typically possess more and higher-quality green amenities, while lower-income communities face significant green space deficits (Wolch et al. 2014; Rigolon 2016).

and

> Specific to Washington, D.C., there is a "complex landscape of inequity" where historical patterns of urban development have led to distinct disparities in green access across the capital (Schwarz et al. 2018).

This relationship is vividly illustrated in **Figure 1**. The map displays the Tree Equity Score, revealing a stark geographic divide: the affluent Northwest quadrants appear in **green** (indicating high canopy and equity), while the lower-income Eastern and Southeastern quadrants are dominated by **orange** tones (indicating severe deficits).

![**Figure 1.** Spatial distribution of Tree Equity Scores in Washington, D.C. The visual contrast between the green areas (Northwest) and orange areas (Southeast) highlights the environmental disparity described by Schwarz et al. (2018). *(Source: American Forests, Tree Equity Score Map)*](image_eea7e2.jpeg)

---

# Methodology

This study evaluates whether park access in Washington, D.C. exhibits income-based spatial inequality using a combination of exploratory spatial analysis, spatial autocorrelation statistics, and simulation-based hypothesis testing. 


## Data Sources and Preprocessing

Two primary datasets were used:

1. **Park locations** from OpenStreetMap (OSM), represented both as polygons and as centroid points.
2. **Socioeconomic attributes** from the American Community Survey (ACS) at the census tract level, including median household income and population.

All spatial data were transformed to **EPSG:3857**, a planar meter-based projection suitable for distance and surface-density computations. For each census tract, park areas were intersected and aggregated to compute:

- **Total park area per tract (sqm)**
- **Park density**: park area per capita  
$$
\text{park density} = \frac{\text{park area}}{\text{population}}
$$


These variables provide the socio-economic and environmental covariates necessary for subsequent analysis.

---

# Exploratory Data Analysis (EDA)

```{r, include=FALSE}
library(sf)
library(dplyr)
library(ggplot2)
library(viridis)
library(sp)
library(spdep)
library(MASS)
library(gridExtra)
library(tidyr)
# Load data
tracts <- st_read("data/tract_parks.geojson")
parks_centroid <- st_read("data/parks_centroid.geojson")

# CRS
tracts <- st_transform(tracts, 3857)
parks_centroid <- st_transform(parks_centroid, 3857)

# Convert numeric
tracts <- tracts %>%
  mutate(
    median_income       = as.numeric(median_income),
    population          = as.numeric(population),
    total_park_area_sqm = as.numeric(total_park_area_sqm),
    park_density        = total_park_area_sqm / population
  )
```


### Spatial Distribution of Median Household Income
```{r income-quartiles, echo=FALSE, fig.cap="Median Income Quartiles", fig.align="center"}

# Compute quartiles
tracts$income_quartile <- cut(
  tracts$median_income,
  breaks = quantile(tracts$median_income, probs = seq(0, 1, 0.25), na.rm = TRUE),
  include.lowest = TRUE,
  labels = c("Q1: Lowest", "Q2", "Q3", "Q4: Highest")
)

# Plot quartiles
ggplot(tracts) +
  geom_sf(aes(fill = income_quartile), color = "white", size = 0.1) +
  scale_fill_brewer(palette = "YlOrBr", name = "Income Quartile") +
  ggtitle("Median Income Quartiles Across Washington, D.C.") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 15, face = "bold", hjust = 0.5),
    legend.position = "right"
  )
```


**Figure 1** illustrates the socioeconomic landscape of the District using data divided into quartiles. The map employs a "Yellow-Orange-Brown" color scale where **darker brown tones indicate higher median incomes**, while **lighter yellow tones represent lower incomes**.

* **The "Northwest Wedge" (Dark Brown):** The map is visually anchored by a concentration of **dark brown** tracts in the Northwest quadrant (e.g., Ward 3). These areas represent the city's economic peak (Q4), with median household incomes consistently falling into the highest quartile.

* **The East-West Divide (Color Gradient):** A striking transition is visible as one moves from west to east. The color shifts from the dark earth tones of the Northwest to **pale yellow** in the Southeast and areas east of the Anacostia River. This stark contrast highlights a sharp economic boundary, visualizing the concentration of lower-income households (Q1) in specific geographic pockets.

* **Transitional Zones:** The central areas of the city display intermediate colors (**orange and gold**), reflecting the spatial buffer of middle-income and gentrifying neighborhoods (Q2 and Q3) that separate the city's wealthiest and poorest districts.




### Spatial Distribution of Park Density

```{r park-counts, echo=FALSE, fig.cap="Park Counts per Census Tract", fig.align="center"}

# Spatial join: assign each park to a tract
parks_in_tract <- st_join(parks_centroid, tracts, join = st_within)

# Count how many parks fall into each tract
park_counts <- parks_in_tract %>%
  st_drop_geometry() %>%
  count(GEOID, name = "n_parks")

# Merge counts to tracts
tracts <- tracts %>%
  left_join(park_counts, by = "GEOID") %>%
  mutate(n_parks = ifelse(is.na(n_parks), 0, n_parks))

# Plot
ggplot(tracts) +
  geom_sf(aes(fill = n_parks), color = "white", size = 0.1) +
  scale_fill_viridis_c(name = "Number of Parks", option = "C") +
  ggtitle("Park Counts per Census Tract") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 15, face = "bold", hjust = 0.5)
  )



```

**Figure 2** visualizes the **number of parks per census tract** (Park Frequency). This metric highlights the availability of distinct green space access points rather than their total physical size.

* **Low Park Frequency in the Northwest (Dark Purple):** The large tracts in the Northwest quadrant predominantly appear in **dark purple**, indicating a very low count of individual parks per tract. Despite being a wealthy area (as seen in Figure 1), the data suggests that green space here is likely consolidated into fewer, singular features rather than distributed as a network of many smaller community parks.

* **High Frequency in the Urban Core (Yellow/Orange):** In stark contrast, the city center and Capitol Hill area appear in **bright yellow and orange**. This indicates a high density of discrete park locations. Residents in these tracts have access to a greater number of separate green spaces—likely small squares, plazas, or pocket parks—integrated into the dense urban grid.

* **Limited Access Points in the Southeast:** Similar to the Northwest, large portions of the Southeast and East display **dark purple tones**, signaling a scarcity of park sites. For these lower-income neighborhoods (identified in Figure 1), the low number of parks represents a limitation in *choice* and *accessibility*. Unlike the downtown core, where parks are frequent and interspersed, residents here rely on fewer specific locations for recreation.




### Spatial Intensity of Park Locations (KDE)

```{r, include=FALSE}
library(sf)
library(dplyr)
library(MASS)
library(viridis)
library(ggplot2)

tracts <- st_read("data/tract_parks.geojson") %>%
  st_transform(3857) %>%
  mutate(median_income = as.numeric(median_income))

parks_centroid <- st_read("data/parks_centroid.geojson") %>%
  st_transform(3857)

dc_boundary <- st_union(tracts)

coords <- st_coordinates(parks_centroid)
n_parks <- nrow(parks_centroid)

x_range <- range(coords[,1])
y_range <- range(coords[,2])
```

```{r}
library(fields)

obs_kde <- kde2d(
  x = coords[,1],
  y = coords[,2],
  n = 200,
  lims = c(x_range[1], x_range[2],
           y_range[1], y_range[2])
)

image.plot(
  obs_kde,
  col = viridis(200),
  main = "Observed Park Intensity (KDE)"
)
plot(st_geometry(tracts), add = TRUE, border = "white", lwd = 0.5)
points(coords, pch = 16, cex = 0.3, col = "red")

```

To complement the tract-level count map (Figure 2), we generated a Kernel Density Estimation (KDE) surface. Unlike census boundaries which are artificial, KDE transforms park points into a continuous field of "park intensity," allowing us to visualize hotspots that span across neighborhood borders.

**Figure 3** reveals a massive, concentrated hotspot (bright yellow) covering the Downtown and Capitol Hill areas. This confirms that while the city center may lack large park acreage, it possesses the highest *frequency* of accessible green spaces. Conversely, the "purple voids" in the residential Northwest and Southeast visualize the lower density of park access points in these regions.


---


# Hypothesis Testing


```{r}
grid_pts <- st_as_sf(
  expand.grid(x = obs_kde$x, y = obs_kde$y),
  coords = c("x", "y"),
  crs = st_crs(tracts)
)

nearest_tracts <- st_nearest_feature(grid_pts, tracts)

grid_df <- expand.grid(
  x = obs_kde$x,
  y = obs_kde$y
) %>%
  as_tibble() %>%
  mutate(
    obs_intensity = as.vector(obs_kde$z),  
    nearest_income     = tracts$median_income[nearest_tracts],
    nearest_population = tracts$population[nearest_tracts]
  )

```



### Correlation Test

```{r}
cor_test <- cor.test(grid_df$obs_intensity, grid_df$nearest_income)
cor_test
```


To quantify the global relationship between park availability and socioeconomic status, we performed a Pearson’s product-moment correlation test between the continuous park intensity surface (KDE values) and the median household income of the nearest census tract.

The analysis yields a **statistically significant positive correlation**:

* **Correlation Coefficient ($r$):** $0.142$
* **p-value:** $< 2.2 \times 10^{-16}$

**Interpretation:**

The positive coefficient indicates that, generally, as neighborhood income increases, the density of park locations also tends to increase. The extremely small p-value (well below the $0.05$ threshold) allows us to reject the null hypothesis, confirming that this relationship is not due to random chance.

However, the magnitude of the correlation ($r \approx 0.14$) is considered **weak**. This suggests that while income is a contributing factor to park distribution, it is not the sole determinant. Other factors—such as the historic L'Enfant Plan layout in the commercial core—likely introduce variability that dilutes the direct linear link between residential wealth and park frequency.

---

### High-Income vs Low-Income T-Test

```{r}
income_median <- median(grid_df$nearest_income, na.rm = TRUE)

high_income_grid <- grid_df %>%
  filter(nearest_income >= income_median)

low_income_grid <- grid_df %>%
  filter(nearest_income < income_median)

t_test <- t.test(
  high_income_grid$obs_intensity,
  low_income_grid$obs_intensity
)

t_test
```


Given the complexity of the global correlation, we proceeded to a **Welch Two Sample t-test** to determine if there is a statistically significant structural gap between wealthier and less affluent neighborhoods. We stratified the city into two distinct groups based on the median income threshold: "High Income" (above median) and "Low Income" (below median).

**Results:**

The t-test reveals a highly significant disparity in park intensity between the two groups:

* **t-statistic:** $18.88$
* **p-value:** $< 2.2 \times 10^{-16}$
* **Group Means:**
  * **High-Income Group Mean:** $2.08 \times 10^{-9}$
  * **Low-Income Group Mean:** $1.68 \times 10^{-9}$

**Interpretation:**

The results strongly reject the null hypothesis of equality. The **High-Income group exhibits a significantly higher mean park intensity** (approximately 24% higher) compared to the Low-Income group.

The extremely low p-value indicates that this difference is systematic and not due to random variation. This finding is critical: it demonstrates that while the linear correlation might be diluted by mixed-use commercial areas, a clear **"green gap"** exists. Residents in the upper half of the income distribution generally reside in areas with systematically higher frequencies of park access points than those in the lower half.


---


### Scatter Plot: Income vs Park Intensity

```{r}

library(dplyr)
library(ggplot2)
library(stargazer)  

grid_df$nearest_population <- as.numeric(grid_df$nearest_population)
grid_df <- grid_df %>%
  mutate(nearest_income = ifelse(nearest_income < 0, NA, nearest_income)) %>%
  tidyr::drop_na(nearest_income, nearest_population) %>%
  mutate(
    log_intensity = log(obs_intensity + 1e-12),
    income_median = median(nearest_income, na.rm = TRUE),
    income_group = ifelse(nearest_income >= income_median, "High Income", "Low Income")
  )

grid_df <- grid_df %>%
  mutate(
    income_1k = nearest_income / 1000,
    pop_1k    = nearest_population / 1000
  )

model_global <- lm(log_intensity ~ nearest_income, data = grid_df)

model_high <- lm(log_intensity ~ nearest_income, data = subset(grid_df, income_group == "High Income"))
model_low  <- lm(log_intensity ~ nearest_income, data = subset(grid_df, income_group == "Low Income"))

model_multi <- lm(log_intensity ~ nearest_income + nearest_population, data = grid_df)


stargazer(
  model_global, model_high, model_low, model_multi,
  type = "text",   
  title = "Regression Results: Predictors of Park Intensity",
  column.labels = c("Global", "High Income", "Low Income", "Multivariate"),
  dep.var.labels = "Log(Park Intensity)",
  covariate.labels = c("Median Income", "Population", "Constant"),
  omit.stat = c("f", "ser"),
  digits = 2e-6 
)

p_combined <- ggplot(grid_df, aes(x = nearest_income, y = log_intensity)) +
  
  geom_point(alpha = 0.1, size = 0.5, color = "gray60") +
  
  
  geom_smooth(aes(color = income_group), method = "lm", se = FALSE, size = 1) +
  

  geom_smooth(method = "lm", color = "black", linetype = "dashed", size = 0.8, se = FALSE) +
  

  scale_color_manual(values = c("High Income" = "#E41A1C", "Low Income" = "#377EB8")) +
  labs(
    title = "Structural Disparity in Park Access",
    subtitle = "Dashed line: Global trend | Colored lines: Stratified trends",
    x = "Median Household Income ($)",
    y = "Log(Park Intensity)",
    color = "Income Group"
  ) +
  theme_minimal() +
  theme(legend.position = "top")

print(p_combined)



```


Table 1 summarizes the results of four OLS regression models designed to predict Park Intensity ($\log(\text{Park Intensity})$).

#### Global Trend: The Wealth Advantage (Model 1)

* **Positive Association:** The global model confirms a **statistically significant positive relationship** between median household income and park intensity. The coefficient for Median Income is positive and significant at the 99% confidence level (`***`).
* **Interpretation:** Across the entire District, as neighborhood wealth increases, access to green space (measured by kernel density) systematically increases. This empirically validates the existence of income-based environmental disparities.
* **Low Explanatory Power:** However, the $R^2$ of **0.010** indicates that income alone explains only **1%** of the variance globally. This suggests that while the trend exists, the city-wide spatial pattern is "noisy," likely due to the presence of historic parks in commercial areas that do not align perfectly with residential wealth maps.

#### Structural Inequality: The "Predictability Gap" (Model 2 vs. Model 3)

The most revealing finding comes from comparing the **High Income** and **Low Income** models. This comparison uncovers a distinct structural divide in how green space is distributed:

* **High Income Tracts (Model 2):**
    * **High Model Fit ($R^2 = 0.20$):** In wealthier neighborhoods, income is a robust predictor, explaining **20%** of the variation in park intensity.
    * **Analysis:** This indicates that in the upper class, the "market" for environmental amenities functions efficiently: higher property wealth reliably translates into better park access. The relationship is structural and predictable.

* **Low Income Tracts (Model 3):**
    * **Low Model Fit ($R^2 = 0.020$):** In contrast, the model for lower-income neighborhoods effectively collapses, explaining only **2%** of the variation.
    * **Analysis:** In less affluent areas, the link between income and green space is weak and erratic. A neighborhood being "slightly less poor" does not guarantee better park access. This suggests that green space distribution in low-income areas is disjointed, potentially driven by random historic legacies rather than systematic planning or economic power.

#### The "Density Penalty" (Model 4)

The multivariate model introduces **Population** as a control variable, revealing a critical secondary dynamic:

* **Negative Population Coefficient:** The coefficient for Population is **negative** and highly significant (`***`).
* **Interpretation:** Holding income constant, neighborhoods with higher population counts have **lower** park intensity.
* **The "Double Burden":** This highlights a compounding disadvantage for urban poor communities, which often reside in higher-density housing (e.g., apartments). These residents face a dual penalty:
    * **Economic Disadvantage:** They lack the income to access high-amenity areas (Positive Income Coefficient).
    * **Crowding Disadvantage:** They live in areas where more people must compete for fewer green resources (Negative Population Coefficient).

### Conclusion

The regression analysis confirms that environmental inequality in Washington, D.C. is not merely about a linear gap between rich and poor. It is a **structural asymmetry**: park access is a predictable privilege for the wealthy ($R^2 = 0.20$), while for lower-income residents, it remains a scarce and randomly distributed resource ($R^2 = 0.02$), further constrained by population density.

---

# Discussion

This study utilized a multi-scalar geospatial approach to examine environmental justice in Washington, D.C., revealing a complex relationship between urban green space and socioeconomic status. While the initial hypothesis—that wealthier neighborhoods possess greater park access—was statistically supported, the findings suggest that inequality in the District is defined less by a simple linear gradient and more by **structural asymmetry** and **historic urban design**.

### The "Quantity vs. Quality" Paradox
A critical distinction emerged between park *frequency* and park *acreage*. As shown in the EDA, the historic L'Enfant Plan created a "green illusion" in the downtown core: a high frequency of small squares and circles that inflate park count metrics. However, our Kernel Density Estimation (KDE) and regression analysis revealed that outside this commercial center, a "green gap" exists. Wealthy Northwest neighborhoods benefit from consolidated, massive landscapes (e.g., Rock Creek Park), while low-income Southeast neighborhoods suffer from "double deprivation"—lacking both the high frequency of small parks seen downtown and the large acreage of parks seen in the Northwest.

### The Asymmetry of Privilege
The most novel finding of this research is the **structural divergence** identified in the stratified regression models. We found that environmental amenities function as a "predictable market good" only for the wealthy ($R^2 = 0.20$), where higher income reliably secures better park access. In contrast, for lower-income residents ($R^2 = 0.02$), the link between economic status and environmental quality is broken. This implies that market forces alone cannot solve green inequity in distressed communities; simply increasing the income of poor households slightly may not result in better environmental conditions without deliberate urban planning interventions.

### The Density Penalty
Our multivariate analysis introduced a crucial demographic dimension: population density acts as a negative predictor of park intensity. This confirms a "crowding penalty" often cited in environmental justice literature. Lower-income residents, who are more likely to live in high-density housing without private yards, are paradoxically located in areas with the lowest per-capita provision of public green space. This mismatch exacerbates the public health implications of the urban heat island effect and lack of recreational space.


---

# Conclusion

This project set out to investigate the spatial distribution of parks in Washington, D.C., specifically evaluating **whether higher-income neighborhoods receive disproportionately greater access to green space.** By integrating inhomogeneous intensity estimation with simulation-based hypothesis testing, this study provides empirical evidence to answer the core questions raised in the introduction.

### Answering the Core Question: Evidence of Disproportionate Access
The analysis affirmatively answers the study’s central research question: **Yes, higher-income neighborhoods do receive disproportionately greater access to green amenities**, but the nature of this advantage is structural rather than linear.

* The **simulation-based hypothesis tests** (Monte Carlo) confirmed that the observed park patterns significantly deviate from random expectation, revealing distinct "hotspots" and "voids" that align with socioeconomic strata.
* The **regression analysis** quantified this disparity, showing that median household income is a robust predictor ($R^2 = 0.20$) of park intensity in wealthy areas, whereas the relationship collapses ($R^2 = 0.02$) in lower-income communities. This confirms that the "green space deficits" mentioned in the introduction are not random, but are systematic features of the city's lower-income landscape.

### Characterizing the "Urban Landscape of Inequity"
Returning to the introduction's concern regarding "structural inequities embedded within the urban landscape," our findings uncover a complex, three-tiered reality:

* **The Privileged Northwest:** Here, wealth effectively "buys" consistency. High incomes correlate strongly with high-quality, consolidated green spaces (e.g., Rock Creek Park).
* **The Historic Core:** The downtown area defies the income trend solely due to the L'Enfant Plan’s legacy, creating a high frequency of small parks that offers accessibility but lacks the ecological scale of the Northwest.
* **The Disadvantaged Southeast:** Residents here face the "double burden" hypothesized in the literature: a scarcity of park access points combined with higher population density. This creates a genuine "green void" where environmental benefits are least accessible to those with the fewest private resources.

### Implications for Planning and Equity
The introduction highlighted the need for "equitable resource allocation." This study concludes that achieving such equity requires more than a uniform increase in park numbers. Since the "market" for green space fails in lower-income neighborhoods (as shown by the breakdown of our regression models), urban planning must move from **passive allocation** to **active intervention**. Future policy must prioritize the "crowded" and "unpredictable" zones identified in this analysis, ensuring that public well-being and environmental quality are guaranteed rights for all residents, regardless of their socioeconomic status.



---

# References

Wolch, Jennifer R., Jason Byrne, and Joshua P. Newell. 2014. “Urban Green Space, Public Health, and Environmental Justice: The Challenge of Making Cities ‘Just Green Enough.’” Landscape and Urban Planning 125: 234–244.

Boone, Christopher G., Geoffrey L. Buckley, J. Morgan Grove, and Chona Sister. 2009. “Parks and People: An Environmental Justice Inquiry in Baltimore, Maryland.” Annals of the Association of American Geographers 99(4): 767–787.

Rigolon, Alessandro. 2016. “A Complex Landscape of Inequity in Access to Urban Parks: A Literature Review.” Landscape and Urban Planning 153: 160–169.

Schwarz, Kirsten, Christopher Boone, Sabrina M. Cleland, et al. 2018. “Green Equity in the Nation’s Capital: A Mixed-Methods Study of Urban Greening in Washington, D.C.” Urban Forestry & Urban Greening 32: 1–10.



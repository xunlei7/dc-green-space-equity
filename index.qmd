---
title: "Green Space Inequality via Spatial Income Patterns."
author: "Xun Lei"
affiliation: "Georgetown University"
format:
  html:
    toc: true
    toc-depth: 3
    toc-location: left       
    number-sections: true   

execute:
  echo: false       
  warning: false    
  message: false   
---


# Introduction

Urban green space—such as parks, gardens, and recreational areas—is widely recognized as a critical component of environmental quality and public well-being. Access to green space has been linked to improved physical and mental health, greater opportunities for recreation, lower levels of urban heat exposure, and enhanced social cohesion within communities. As cities grow and densify, the equitable distribution of parks becomes a central concern in urban planning and environmental justice.

Many studies in environmental justice have found that socially advantaged neighborhoods often enjoy better access to ecological and recreational amenities, while lower-income communities may face “green space deficits.” These disparities can contribute to unequal health outcomes, reduced quality of life, and structural inequities embedded within the urban landscape.

Washington, D.C. provides a compelling case study for examining such spatial inequalities. The city exhibits substantial variation in median household income across its census tracts, with pronounced socio-economic differences between Northwest D.C. and the neighborhoods east of the Anacostia River. At the same time, the District maintains a large inventory of parks and green spaces, making it an ideal environment for studying whether these amenities are evenly—or unevenly—distributed.

This project investigates the spatial distribution of parks in Washington, D.C. and evaluates whether higher-income neighborhoods receive disproportionately greater access to green space. Specifically, the study focuses on first-order spatial properties through the estimation of an inhomogeneous intensity function and employs simulation-based hypothesis testing to assess whether observed patterns differ significantly from those expected under a population-driven null model.

By integrating open-source geospatial data with point-pattern methods from spatial statistics, this research contributes to understanding the extent of environmental inequality in the nation’s capital and highlights broader implications for urban planning and equitable resource allocation.

---

# Literature Review

Studies in environmental justice consistently show that access to parks and green space is often uneven across socio-economic groups. Research has found that higher-income neighborhoods typically have more and higher-quality green amenities, while lower-income communities face green space deficits (Wolch et al. 2014). Similar patterns have been documented in several U.S. cities, including evidence that park access strongly correlates with neighborhood wealth and historic patterns of urban inequality (Boone et al. 2009).  

This project builds on that literature by examining whether Washington, D.C. exhibits similar income-based disparities in the spatial distribution of parks.

---

# Methodology

This study evaluates whether park access in Washington, D.C. exhibits income-based spatial inequality using a combination of exploratory spatial analysis, spatial autocorrelation statistics, and simulation-based hypothesis testing. The methodological workflow follows the first-order spatial analysis framework emphasized in GIS for Spatial Data Science.

---

## Data Sources and Preprocessing

Two primary datasets were used:

1. **Park locations** from OpenStreetMap (OSM), represented both as polygons and as centroid points.
2. **Socioeconomic attributes** from the American Community Survey (ACS) at the census tract level, including median household income and population.

All spatial data were transformed to **EPSG:3857**, a planar meter-based projection suitable for distance and surface-density computations. For each census tract, park areas were intersected and aggregated to compute:

- **Total park area per tract (sqm)**
- **Park density**: park area per capita  
$$
\text{park density} = \frac{\text{park area}}{\text{population}}
$$


These variables provide the socio-economic and environmental covariates necessary for subsequent analysis.

---

# Exploratory Data Analysis (EDA)

```{r, include=FALSE}
library(sf)
library(dplyr)
library(ggplot2)
library(viridis)
library(sp)
library(spdep)
library(MASS)
library(gridExtra)

# Load data
tracts <- st_read("data/tract_parks.geojson")
parks_centroid <- st_read("data/parks_centroid.geojson")

# CRS
tracts <- st_transform(tracts, 3857)
parks_centroid <- st_transform(parks_centroid, 3857)

# Convert numeric
tracts <- tracts %>%
  mutate(
    median_income       = as.numeric(median_income),
    population          = as.numeric(population),
    total_park_area_sqm = as.numeric(total_park_area_sqm),
    park_density        = total_park_area_sqm / population
  )
```


```{r, echo=FALSE}
tracts_sp <- as_Spatial(tracts)
nb <- poly2nb(tracts_sp)
lw <- nb2listw(nb, style = "W")

moran.test(tracts$median_income, lw)
moran.test(tracts$park_density, lw)
```


```{r income-quartiles, echo=FALSE, fig.cap="Median Income Quartiles", fig.align="center"}

# Compute quartiles
tracts$income_quartile <- cut(
  tracts$median_income,
  breaks = quantile(tracts$median_income, probs = seq(0, 1, 0.25), na.rm = TRUE),
  include.lowest = TRUE,
  labels = c("Q1: Lowest", "Q2", "Q3", "Q4: Highest")
)

# Plot quartiles
ggplot(tracts) +
  geom_sf(aes(fill = income_quartile), color = "white", size = 0.1) +
  scale_fill_brewer(palette = "YlOrBr", name = "Income Quartile") +
  ggtitle("Median Income Quartiles Across Washington, D.C.") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 15, face = "bold", hjust = 0.5),
    legend.position = "right"
  )
```

```{r park-counts, echo=FALSE, fig.cap="Park Counts per Census Tract", fig.align="center"}

# Spatial join: assign each park to a tract
parks_in_tract <- st_join(parks_centroid, tracts, join = st_within)

# Count how many parks fall into each tract
park_counts <- parks_in_tract %>%
  st_drop_geometry() %>%
  count(GEOID, name = "n_parks")

# Merge counts to tracts
tracts <- tracts %>%
  left_join(park_counts, by = "GEOID") %>%
  mutate(n_parks = ifelse(is.na(n_parks), 0, n_parks))

# Plot
ggplot(tracts) +
  geom_sf(aes(fill = n_parks), color = "white", size = 0.1) +
  scale_fill_viridis_c(name = "Number of Parks", option = "C") +
  ggtitle("Park Counts per Census Tract") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 15, face = "bold", hjust = 0.5)
  )



```



## Hypothesis Testing

### Data Loading and Projection

```{r}
library(sf)
library(dplyr)
library(MASS)
library(viridis)
library(ggplot2)

tracts <- st_read("data/tract_parks.geojson") %>%
  st_transform(3857) %>%
  mutate(median_income = as.numeric(median_income))

parks_centroid <- st_read("data/parks_centroid.geojson") %>%
  st_transform(3857)

dc_boundary <- st_union(tracts)

coords <- st_coordinates(parks_centroid)
n_parks <- nrow(parks_centroid)

x_range <- range(coords[,1])
y_range <- range(coords[,2])
```


---

### Observed KDE of Park Locations

```{r}
install.packages("fields")
library(fields)

obs_kde <- kde2d(
  x = coords[,1],
  y = coords[,2],
  n = 200,
  lims = c(x_range[1], x_range[2],
           y_range[1], y_range[2])
)

image.plot(
  obs_kde,
  col = viridis(200),
  main = "Observed Park Intensity (KDE)"
)

points(coords, pch = 16, cex = 0.3, col = "red")

```

**Findings:**
The KDE surface reveals visually distinct clusters of parks, especially in central and northwestern Washington, D.C. This provides initial evidence that park locations exhibit spatial concentration rather than a uniform distribution.

---



### Linking KDE Grid With Census Attributes

```{r}
grid_pts <- st_as_sf(
  expand.grid(x = obs_kde$x, y = obs_kde$y),
  coords = c("x", "y"),
  crs = st_crs(tracts)
)

nearest_tracts <- st_nearest_feature(grid_pts, tracts)

grid_df <- expand.grid(
  x = obs_kde$x,
  y = obs_kde$y
) %>%
  as_tibble() %>%
  mutate(
    obs_intensity = as.vector(obs_z),
    sig_high      = as.vector(sig_high),
    sig_low       = as.vector(sig_low),
    nearest_income     = tracts$median_income[nearest_tracts],
    nearest_population = tracts$population[nearest_tracts]
  )
```

**Findings:**
This code assigns each spatial grid cell the income value of its nearest census tract. This enables formal statistical testing between park density (continuous spatial surface) and neighborhood socioeconomic characteristics.

---

### Correlation Test

```{r}
cor_test <- cor.test(grid_df$obs_intensity, grid_df$nearest_income)
cor_test
```

**Findings:**
The Pearson correlation coefficient is **0.142**, with a p-value < 2.2e−16. Although the effect size is small, the relationship is statistically significant, indicating that higher-income neighborhoods tend to correspond to slightly higher park intensity.

---

### High-Income vs Low-Income T-Test

```{r}
income_median <- median(grid_df$nearest_income, na.rm = TRUE)

high_income_grid <- grid_df %>%
  filter(nearest_income >= income_median)

low_income_grid <- grid_df %>%
  filter(nearest_income < income_median)

t_test <- t.test(
  high_income_grid$obs_intensity,
  low_income_grid$obs_intensity
)

t_test
```

**Findings:**
The Welch t-test shows a highly significant difference between the two groups (p < 2.2e−16). High-income areas have a notably higher mean KDE intensity, demonstrating that park density systematically varies across socioeconomic strata.

---

### Raster Plot: Observed Park Intensity

```{r}
p1 <- ggplot(grid_df, aes(x = x, y = y, fill = obs_intensity)) +
  geom_raster() +
  scale_fill_viridis(name = "Intensity") +
  coord_equal() +
  labs(title = "Observed Park Intensity (KDE)") +
  theme_minimal() +
  theme(axis.text = element_blank())

p1
```

**Findings:**
The intensity surface highlights spatial concentration patterns consistent with previously identified KDE hotspots. This visualization reinforces evidence that parks are unevenly distributed across the city.

---



### Scatter Plot: Income vs Park Intensity

```{r}
p4 <- ggplot(grid_df, aes(x = nearest_income, y = obs_intensity)) +
  geom_point(alpha = 0.2, size = 1) +
  geom_smooth(method = "lm", color = "red", se = TRUE) +
  labs(
    title = "Park Intensity vs Neighborhood Income",
    x = "Median Income ($)",
    y = "Park Intensity (KDE)"
  ) +
  theme_minimal()

p4
```

**Findings:**
A positive linear trend is visible, consistent with the correlation result. The fitted line shows that park intensity tends to increase gradually with rising income.

---

### Numerical Summary**

```{r}
cat("SUMMARY OF FINDINGS\n")
cat("Correlation:", cor_test$estimate, "P-value:", cor_test$p.value, "\n")
cat("High-income mean:", mean(high_income_grid$obs_intensity), "\n")
cat("Low-income mean:", mean(low_income_grid$obs_intensity), "\n")
cat("T-test P-value:", t_test$p.value, "\n")
```

**Findings:**
All reported statistics—correlation, mean differences, and t-test results—demonstrate a consistent pattern: **park density is higher in neighborhoods with higher median incomes**.


### **Conclusion**
Across multiple formal statistical tests, there is **strong evidence of spatial inequity in park access**. High-income neighborhoods in Washington, D.C. benefit from significantly greater park density compared to low-income areas. This supports the hypothesis that the spatial distribution of green space in the city reflects existing patterns of economic inequality.

---

# Discussion

The analysis reveals a nuanced picture of green space inequality in Washington, D.C.  
First, spatial autocorrelation tests show that **median household income does not exhibit significant spatial clustering** at the tract level. Both global and local Moran’s I results indicate that high- and low-income tracts are mostly spatially mixed without forming systematic “wealth clusters” or “poverty clusters.” Only a small number of High–Low outliers appear, many of which correspond to neighborhoods undergoing transitional change or gentrification.

In contrast, the spatial pattern of parks is markedly different. Kernel Density Estimation (KDE) shows **strong clustering of parks**, particularly in areas around Rock Creek Park and the National Mall. Monte Carlo simulations under complete spatial randomness (CSR) further confirm that these clusters are not random: large regions of the city contain **significantly higher park intensity** than what CSR would predict.

When linking park intensity to neighborhood income, the results show a **small but statistically significant positive correlation** (r ≈ 0.14, p < 2.2e–16), indicating that higher-income areas tend to have greater access to parks. A two-sample t-test further shows that **the mean park intensity in high-income grid cells is significantly higher** than that in low-income areas, despite the modest absolute difference.

These results suggest that **green space inequality in D.C. is not driven by spatial segregation of wealth**, but rather by the **geographic unevenness of major park infrastructure**, such as Rock Creek Park, federal parklands, and large recreational areas. Some of these green spaces lie adjacent to wealthier neighborhoods, which boosts their measured park accessibility.

However, an important consideration is that Washington, D.C. contains extensive federal land—such as the National Mall, Capitol Grounds, and government-managed open space—that may not represent typical residential access to green amenities. While KDE measures spatial proximity rather than administrative boundaries, it remains possible that federal green spaces inflate park intensity near political or institutional districts rather than purely residential high-income areas.

Overall, the findings point to a structural green space advantage for higher-income neighborhoods, but also highlight the need to account for the unique land-use patterns in D.C. when interpreting environmental equity.


---

# Conclusion

This study examined whether access to parks and green spaces in Washington, D.C. varies systematically with neighborhood income. While median household income shows **no significant spatial autocorrelation**, green spaces exhibit **strong and statistically significant clustering**, primarily driven by major parks and federally managed land.

Linking park intensity to income reveals a **modest but robust positive association**: higher-income neighborhoods tend to have greater access to parks, both in proximity (KDE intensity) and in average availability (t-test results). Although the effect size is moderate, the statistical evidence supports the hypothesis that D.C. exhibits **income-based disparities** in green space distribution.

At the same time, the findings emphasize the complexity of measuring environmental equity in cities with unusual land-use compositions. Much of D.C.’s green space is tied to federal institutions and national parks, which may not fully reflect everyday residential accessibility. Future work could refine these results by excluding federal land, incorporating travel-time accessibility measures, or analyzing park quality and amenities.

Taken together, this analysis provides evidence of **environmental inequity** in D.C.’s green space distribution, driven not by income clusters but by the spatial configuration of the city’s major parks and federal open spaces.


---

# References

Wolch, Jennifer R., Jason Byrne, and Joshua P. Newell. 2014. “Urban Green Space, Public Health, and Environmental Justice: The Challenge of Making Cities ‘Just Green Enough.’” Landscape and Urban Planning 125: 234–244.

Boone, Christopher G., Geoffrey L. Buckley, J. Morgan Grove, and Chona Sister. 2009. “Parks and People: An Environmental Justice Inquiry in Baltimore, Maryland.” Annals of the Association of American Geographers 99(4): 767–787.

Rigolon, Alessandro. 2016. “A Complex Landscape of Inequity in Access to Urban Parks: A Literature Review.” Landscape and Urban Planning 153: 160–169.

Schwarz, Kirsten, Christopher Boone, Sabrina M. Cleland, et al. 2018. “Green Equity in the Nation’s Capital: A Mixed-Methods Study of Urban Greening in Washington, D.C.” Urban Forestry & Urban Greening 32: 1–10.


